<div id="the_ghost_face_control_panel">
    <!-- 控制面板 -->
    <div id="the_ghost_face_control_panel_content" class="ghost-theme-responsive">

        <!-- 头部 -->
        <div id="the_ghost_face_control_panel_header">
            <h3 style="margin: 0; -size: 18px; -weight: 600;">
                👻 鬼面控制台
            </h3>
        </div>

        <!-- 可滚动的主体内容 -->
        <div class="ghost-panel-body">
            <!-- 🎯 修复后的按钮区域 - ID必须完整匹配 -->
            <!-- 🎯 新的主要操作区域：3个按钮竖排 -->
            <div class="ghost-main-actions-vertical">
                <!-- 自动开关按钮 -->
                <button id="the_ghost_face_control_panel_toggle_auto" class="ghost-button ghost-auto-toggle"
                    data-auto-enabled="true">
                    🐕 自动总结开启
                </button>

                <!-- 设置菜单按钮 -->
                <button id="the_ghost_face_control_panel_settings_toggle" class="ghost-button ghost-settings-button">
                    ⚙️ 设置菜单
                </button>
            </div>

            <!-- 🎯 可折叠的设置区域 -->
            <div id="the_ghost_face_control_panel_settings_area" style="display: none; margin-bottom: 20px;">

                <!-- 主题选择 -->
                <div style="margin-bottom: 15px;">
                    <label style="color: #ccc; font-size: 12px; margin-bottom: 8px; display: block;">
                        🎨 主题配色
                    </label>
                    <select id="the_ghost_face_control_panel_theme_select" class="ghost-select">
                        <option value="ocean">深海叹息</option>
                        <option value="cyberpunk">赛博朋克</option>
                        <option value="gothic">哥特暗黑</option>
                        <option value="scifi">科技空梦</option>
                        <option value="military">战术迷彩</option>
                        <option value="cosmic">无尽星辰</option>
                        <option value="emerald">翡翠森林</option>
                        <option value="abyss">深渊凝望</option>
                        <option value="thepig">猪猪来咯</option>
                    </select>
                </div>

                <!-- 触发设置 -->
                <div style="margin-bottom: 15px;">
                    <label style="color: #ccc; font-size: 12px; margin-bottom: 8px; display: block;">
                        ⚙️ 触发设置
                    </label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                        <div>
                            <label style="color: #aaa; font-size: 12px;">消息阈值</label>
                            <input id="the_ghost_face_control_panel_threshold_input" type="number" min="10" max="100"
                                value="40" class="ghost-input">
                        </div>
                        <div>
                            <label style="color: #aaa; font-size: 12px;">检测间隔(分)</label>
                            <input id="the_ghost_face_control_panel_interval_input" type="number" min="1" max="60"
                                value="5" class="ghost-input">
                        </div>
                    </div>
                </div>

                <!-- 🎯 指定范围总结 -->
                <div style="margin-bottom: 15px;">
                    <label style="color: #ccc; font-size: 12px; margin-bottom: 8px; display: block;">
                        🎯 指定范围总结
                    </label>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                        <div>
                            <label style="color: #aaa; font-size: 12px;">起始楼层</label>
                            <input id="the_ghost_face_control_panel_manual_start" type="number" min="1" value="1"
                                class="ghost-input" placeholder="开始">
                        </div>
                        <div>
                            <label style="color: #aaa; font-size: 12px;">结束楼层</label>
                            <input id="the_ghost_face_control_panel_manual_end" type="number" min="1" value=""
                                class="ghost-input" placeholder="结束">
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 8px;">
                        <!-- 小总结-->
                        <button id="the_ghost_face_control_panel_manual_summary_range" class="ghost-button">
                            📝 鬼面起来干活
                        </button>

                        <!-- 🧠 大总结 -->
                        <button id="the_ghost_face_control_panel_big_summary_range" class="ghost-button ghost-primary">
                            🧠 大总结
                        </button>
                    </div>
                </div>


                <!-- 🎯 自动分段总结 -->
                <div style="margin-bottom: 15px;">
                    <label style="color: #ccc; font-size: 12px; margin-bottom: 8px; display: block;">
                        🤖 自动分段总结
                    </label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                        <div>
                            <label style="color: #aaa; font-size: 12px;">每段楼层数</label>
                            <input id="the_ghost_face_control_panel_chunk_size" type="number" min="2" max="10" value="4"
                                class="ghost-input">
                        </div>
                        <div>
                            <label style="color: #aaa; font-size: 12px;">保留楼层数</label>
                            <input id="the_ghost_face_control_panel_keep_messages" type="number" min="1" max="10"
                                value="2" class="ghost-input">
                        </div>
                    </div>
                    <button id="the_ghost_face_control_panel_auto_chunk_summary" class="ghost-button"
                        style="margin-top: 8px; width: 100%;">
                        🚀 开始分段总结
                    </button>
                </div>
                <!-- 🤖 自定义API设置 -->
                <div style="margin-bottom: 15px;">
                    <label style="color: #aaa; font-size: 12px; margin-bottom: 12px; display: block;">
                        🤖 自定义API设置
                    </label>

                    <!-- API开关 -->
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                        <input type="checkbox" id="the_ghost_face_control_panel_use_custom_api_checkbox"
                            style="width: 14px; height: 14px;">
                        <label for="the_ghost_face_control_panel_use_custom_api_checkbox"
                            style="color: #ccc; font-size: 12px; margin: 0; cursor: pointer;">
                            启用自定义API（关闭时使用默认）
                        </label>
                    </div>

                    <!-- API配置区域（默认隐藏） -->
                    <div id="the_ghost_face_control_panel_custom_api_config" style="display: none;">
                        <!-- API URL -->
                        <div style="margin-bottom: 8px;">
                            <label style="color: #aaa; font-size: 12px; margin-bottom: 3px; display: block;">
                                API基础URL
                            </label>
                            <input id="the_ghost_face_control_panel_custom_api_url" type="text"
                                placeholder="https://api.openai.com/v1" class="ghost-input"
                                style="font-size: 10px; padding: 6px 8px;">
                        </div>

                        <!-- API密钥 -->
                        <div style="margin-bottom: 8px;">
                            <label style="color: #aaa; font-size: 12px; margin-bottom: 3px; display: block;">
                                API密钥
                            </label>
                            <input id="the_ghost_face_control_panel_custom_api_key" type="password" placeholder="sk-..."
                                class="ghost-input" style="font-size: 10px; padding: 6px 8px;">
                        </div>

                        <!-- 模型选择 -->
                        <div style="margin-bottom: 8px;">
                            <label style="color: #aaa; font-size: 12px; margin-bottom: 3px; display: block;">
                                模型
                            </label>
                            <div style="display: grid; grid-template-columns: 1fr auto; gap: 6px;">
                                <select id="the_ghost_face_control_panel_custom_api_model" class="ghost-select"
                                    style="font-size: 10px; padding: 4px 6px;">
                                    <option value="">请先加载模型</option>
                                </select>
                                <button id="the_ghost_face_control_panel_load_models_button" class="ghost-button"
                                    style="padding: 4px 8px; min-height: 26px; font-size: 12px; white-space: nowrap;">
                                    🔄 加载
                                </button>
                            </div>
                        </div>

                        <!-- API状态 -->
                        <div style="margin-bottom: 8px;">
                            <div id="the_ghost_face_control_panel_api_status"
                                style="font-size: 12px; color: #000000; padding: 4px 6px; background: rgba(255,255,255,0.05); border-radius: 4px;">
                                状态: 未配置
                            </div>
                        </div>

                        <!-- 保存/清除按钮 -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px;">
                            <button id="the_ghost_face_control_panel_save_api_config" class="ghost-button"
                                style="font-size: 12px; min-height: 26px; padding: 4px 6px;">
                                💾 保存
                            </button>
                            <button id="the_ghost_face_control_panel_clear_api_config" class="ghost-button"
                                style="font-size: 12px; min-height: 26px; padding: 4px 6px;">
                                🗑️ 清除
                            </button>
                        </div>

                        <!-- 小贴士 -->
                        <div
                            style="margin-top: 8px; padding: 6px; background: rgba(255,193,7,0.1); border-left: 3px solid #ffc107; border-radius: 0 4px 4px 0;">
                            <div style="font-size: 12px; color: #ffb74d; line-height: 1.3;">
                                💡 支持OpenAI、Claude、Gemini等兼容API<br>
                                🔒 配置信息仅保存在本地浏览器
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 状态信息 -->
            <div class="ghost-status-card">
                <div class="ghost-status-info">
                    <div>📊 总消息数: <span id="the_ghost_face_control_panel_message_count">0</span></div>
                    <div>🎯 自动触发阈值: <span id="the_ghost_face_control_panel_threshold_display">40</span> 条</div>
                    <div>⚡ 自动总结状态: <span id="the_ghost_face_control_panel_status_text">自动尾随中</span></div>
                </div>
            </div>

            <!-- 日志区域 -->
            <div class="ghost-log-section">
                <div class="ghost-log-header">
                    <span class="ghost-log-title">📋 受害者的详细行程</span>
                    <button id="the_ghost_face_control_panel_clear_log" class="ghost-log-clear">清空</button>
                </div>
                <div id="the_ghost_face_control_panel_log_content">
                    <div style="color: #888; font-style: italic;">等待受害者的详细行程...</div>
                </div>
            </div>
        </div>
    </div>
</div>